<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Sidebar Positioning Test</title>
        <link rel="stylesheet" href="css/base/variables.css" />
        <link rel="stylesheet" href="css/base/reset.css" />
        <link rel="stylesheet" href="css/base/typography.css" />
        <link rel="stylesheet" href="css/layout/containers.css" />
        <link rel="stylesheet" href="css/layout/header.css" />
        <link rel="stylesheet" href="css/layout/navigation.css" />
        <link rel="stylesheet" href="css/components/modals.css" />
        <link rel="stylesheet" href="css/components/buttons.css" />
        <link rel="stylesheet" href="css/main.css" />
        <style>
            /* Debug styles */
            .debug-info {
                position: fixed;
                top: 100px;
                right: 20px;
                background: rgba(255, 255, 255, 0.9);
                padding: 1rem;
                border: 1px solid #ccc;
                border-radius: 4px;
                font-family: monospace;
                font-size: 0.8rem;
                z-index: 50000;
                max-width: 300px;
            }
            .test-content {
                height: 300vh;
                background: linear-gradient(to bottom, #f0f0f0, #e0e0e0);
                padding: 2rem;
                margin-top: 2rem;
            }
            .scroll-marker {
                height: 1px;
                background: red;
                margin: 50vh 0;
                position: relative;
            }
            .scroll-marker::after {
                content: 'Scroll marker - ' attr(data-position);
                position: absolute;
                left: 0;
                top: -20px;
                color: red;
                font-weight: bold;
            }
        </style>
    </head>
    <body>
        <header class="main-header">
            <div class="header-content">
                <div class="hamburger-container" id="hamburger-menu">
                    <!-- Navigation will be loaded here -->
                </div>
                <div class="header-title">
                    <h1>Sidebar Positioning Test</h1>
                </div>
            </div>
        </header>

        <div class="menu-overlay" id="menuOverlay"></div>

        <!-- Debug info panel -->
        <div class="debug-info" id="debugInfo">
            <strong>Sidebar Debug Info:</strong><br />
            <span id="sidebarStatus">Not loaded</span><br />
            <span id="sidebarPosition">Position: unknown</span><br />
            <span id="scrollPosition">Scroll: 0</span>
        </div>

        <main class="main-content">
            <div class="content-container">
                <h2>Sidebar Positioning Test</h2>
                <p><strong>Instructions:</strong></p>
                <ol>
                    <li>Click the hamburger menu to open the sidebar</li>
                    <li>Scroll down through this page</li>
                    <li>
                        The sidebar should remain pinned to the left side of the
                        screen
                    </li>
                    <li>Check the debug info panel for positioning details</li>
                </ol>

                <div style="margin: 2rem 0">
                    <button class="btn btn-primary" onclick="debugSidebar()">
                        Debug Sidebar
                    </button>
                    <button
                        class="btn btn-secondary"
                        onclick="forcePinSidebar()"
                    >
                        Force Pin Sidebar
                    </button>
                </div>

                <div class="test-content">
                    <h3>Test Content Area</h3>
                    <p>
                        This is a very tall content area to test scrolling
                        behavior.
                    </p>

                    <div class="scroll-marker" data-position="25%"></div>
                    <p>
                        You should be able to scroll here while the sidebar
                        stays pinned.
                    </p>

                    <div class="scroll-marker" data-position="50%"></div>
                    <p>
                        The sidebar should still be visible and pinned to the
                        left.
                    </p>

                    <div class="scroll-marker" data-position="75%"></div>
                    <p>
                        Even at the bottom, the sidebar should remain pinned if
                        open.
                    </p>

                    <div class="scroll-marker" data-position="100%"></div>
                </div>
            </div>
        </main>

        <!-- Scripts -->
        <script src="js/shared/head-manager.js"></script>
        <script src="js/shared/modal-manager.js"></script>
        <script src="js/shared/navigation.js"></script>
        <script src="js/shared/auth-utils.js"></script>
        <script src="js/main.js"></script>

        <script>
            let debugInterval;

            function debugSidebar() {
                const sidebar = document.querySelector('.side-menu');
                if (sidebar) {
                    const computedStyle = window.getComputedStyle(sidebar);
                    console.log('Sidebar Debug Info:');
                    console.log('Position:', computedStyle.position);
                    console.log('Top:', computedStyle.top);
                    console.log('Left:', computedStyle.left);
                    console.log('Height:', computedStyle.height);
                    console.log('Z-index:', computedStyle.zIndex);
                    console.log('Transform:', computedStyle.transform);
                    console.log('Classes:', sidebar.className);

                    alert(`Sidebar Debug:
Position: ${computedStyle.position}
Top: ${computedStyle.top}
Left: ${computedStyle.left}
Height: ${computedStyle.height}
Z-index: ${computedStyle.zIndex}
Classes: ${sidebar.className}`);
                } else {
                    alert('Sidebar not found!');
                }
            }

            function forcePinSidebar() {
                const sidebar = document.querySelector('.side-menu');
                if (sidebar) {
                    // Force correct positioning
                    sidebar.style.position = 'fixed';
                    sidebar.style.top = '0';
                    sidebar.style.height = '100vh';
                    sidebar.style.zIndex = '1000';
                    sidebar.style.left = sidebar.classList.contains('open')
                        ? '0'
                        : '-300px';
                    console.log('Forced sidebar positioning');
                    alert('Sidebar positioning forced');
                } else {
                    alert('Sidebar not found!');
                }
            }
            function updateDebugInfo() {
                const sidebar = document.querySelector('.side-menu');
                const overlay = document.querySelector('.menu-overlay');
                const statusEl = document.getElementById('sidebarStatus');
                const positionEl = document.getElementById('sidebarPosition');
                const scrollEl = document.getElementById('scrollPosition');

                if (sidebar) {
                    const computedStyle = window.getComputedStyle(sidebar);
                    const isOpen =
                        sidebar.classList.contains('open') ||
                        sidebar.classList.contains('active');

                    statusEl.textContent = isOpen ? 'Open' : 'Closed';
                    positionEl.innerHTML = `Position: ${computedStyle.position}<br>Left: ${computedStyle.left}<br>Top: ${computedStyle.top}<br>Height: ${computedStyle.height}`;
                    scrollEl.innerHTML = `Scroll: ${
                        window.scrollY
                    }px<br>Overlay: ${
                        overlay
                            ? overlay.classList.contains('active')
                                ? 'Active'
                                : 'Inactive'
                            : 'Not found'
                    }`;
                } else {
                    statusEl.textContent = 'Not found';
                }
            }

            // Initialize page
            document.addEventListener('DOMContentLoaded', function () {
                console.log('Sidebar test page loaded');

                // Load navigation
                if (window.loadMenu) {
                    window.loadMenu();
                }

                // Start debug info updates
                debugInterval = setInterval(updateDebugInfo, 500);

                // Update debug info on scroll
                window.addEventListener('scroll', updateDebugInfo);
            });

            // Cleanup
            window.addEventListener('beforeunload', function () {
                if (debugInterval) {
                    clearInterval(debugInterval);
                }
            });
        </script>
    </body>
</html>
